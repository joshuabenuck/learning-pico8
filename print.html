<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/custom.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="overview/overview.html">Overview</a></li><li class="chapter-item expanded "><a href="ag/intro/ag_tutorial.html"><strong aria-hidden="true">1.</strong> Adventure Game Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ag/step_01/the_map.html"><strong aria-hidden="true">1.1.</strong> The Map</a></li><li class="chapter-item expanded "><a href="ag/step_02/the_player.html"><strong aria-hidden="true">1.2.</strong> The Player</a></li><li class="chapter-item expanded "><a href="ag/step_03/movement.html"><strong aria-hidden="true">1.3.</strong> Movement</a></li><li class="chapter-item expanded "><a href="ag/step_04/camera.html"><strong aria-hidden="true">1.4.</strong> Camera</a></li><li class="chapter-item expanded "><a href="ag/step_05/keys.html"><strong aria-hidden="true">1.5.</strong> Keys</a></li><li class="chapter-item expanded "><a href="ag/step_06/inventory.html"><strong aria-hidden="true">1.6.</strong> Inventory</a></li><li class="chapter-item expanded "><a href="ag/step_07/doors.html"><strong aria-hidden="true">1.7.</strong> Doors</a></li><li class="chapter-item expanded "><a href="ag/step_08/animated_tiles.html"><strong aria-hidden="true">1.8.</strong> Animate Tiles</a></li><li class="chapter-item expanded "><a href="ag/step_09/winning_and_losing.html"><strong aria-hidden="true">1.9.</strong> Winning and Losing</a></li><li class="chapter-item expanded "><a href="ag/step_10/trying_again.html"><strong aria-hidden="true">1.10.</strong> Trying Again</a></li><li class="chapter-item expanded "><a href="ag/step_11/bonus_adding_text.html"><strong aria-hidden="true">1.11.</strong> Bonus Step: Adding Text</a></li><li class="chapter-item expanded "><a href="ag/step_12/bonus_unlimited_sprite_types.html"><strong aria-hidden="true">1.12.</strong> Bonus Step: Unlimited Sprite Types</a></li></ol></li><li class="chapter-item expanded "><a href="ss/intro/intro.html"><strong aria-hidden="true">2.</strong> A Space Shooter in 16 Steps</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ss/step_01/draw_ship.html"><strong aria-hidden="true">2.1.</strong> Draw Ship on Screen</a></li><li class="chapter-item expanded "><a href="ss/step_02/animate_propulsion.html"><strong aria-hidden="true">2.2.</strong> Animate Propulsion</a></li><li class="chapter-item expanded "><a href="ss/step_03/ship_movement.html"><strong aria-hidden="true">2.3.</strong> Basic Ship Movement</a></li><li class="chapter-item expanded "><a href="ss/step_04/fire_bullets.html"><strong aria-hidden="true">2.4.</strong> Fire Laser Bullets</a></li><li class="chapter-item expanded "><a href="ss/step_05/remove_bullets.html"><strong aria-hidden="true">2.5.</strong> Remove Bullets</a></li><li class="chapter-item expanded "><a href="ss/step_06/draw_enemies.html"><strong aria-hidden="true">2.6.</strong> Draw Enemies</a></li><li class="chapter-item expanded "><a href="ss/step_07/move_enemies.html"><strong aria-hidden="true">2.7.</strong> Move Enemies</a></li><li class="chapter-item expanded "><a href="ss/step_08/points_and_health.html"><strong aria-hidden="true">2.8.</strong> Points and Health</a></li><li class="chapter-item expanded "><a href="ss/step_09/cleanup_and_prep.html"><strong aria-hidden="true">2.9.</strong> Collision 1: Cleanup and Prep</a></li><li class="chapter-item expanded "><a href="ss/step_10/define_boxes.html"><strong aria-hidden="true">2.10.</strong> Collision 2: Define Boxes</a></li><li class="chapter-item expanded "><a href="ss/step_11/collide_boxes.html"><strong aria-hidden="true">2.11.</strong> Collision 3: Collide Boxes</a></li><li class="chapter-item expanded "><a href="ss/step_12/change_states.html"><strong aria-hidden="true">2.12.</strong> Change states</a></li><li class="chapter-item expanded "><a href="ss/step_13/game_over.html"><strong aria-hidden="true">2.13.</strong> Health, Game Over, Immortaility</a></li><li class="chapter-item expanded "><a href="ss/step_14/explosions.html"><strong aria-hidden="true">2.14.</strong> Explosions</a></li><li class="chapter-item expanded "><a href="ss/step_15/stars.html"><strong aria-hidden="true">2.15.</strong> Stars</a></li><li class="chapter-item expanded "><a href="ss/step_16/enemy_movement.html"><strong aria-hidden="true">2.16.</strong> Enemy Movement and Respawn</a></li></ol></li><li class="chapter-item expanded "><a href="resources/resources.html"><strong aria-hidden="true">3.</strong> Resources</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>PICO-8 is like an emulator for a video game console that was never made. But,
unlike a typical emulator, PICO-8 includes the ability to browse and download
games. What's more, is that the PICO-8 environment includes all the tools you
need to create and modify games, whether they are ones of your own creation or
ones that you downloaded yourself.</p>
<h1 id="environment"><a class="header" href="#environment">Environment</a></h1>
<p>When you first launch PICO-8, you are presented with a command prompt. This is
a bit like the prompt computers that ran MS-DOS would boot to back in the 1980's.</p>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<p>These are some of the commands you can run. Don't run any of these just yet.</p>
<ul>
<li>LS - show the files in the current directory</li>
<li>RUN (or ctrl-r) - run the current cartridge</li>
<li>SAVE (or ctrl-S) - save the current cartridge</li>
<li>INSTALL_DEMOS - install a few demo cartridges</li>
<li>SHUTDWON (or ctrl-q) - quit PICO-8</li>
<li>REBOOT - restart PICO-8</li>
<li>SPLORE - explore community created cartridges</li>
</ul>
<h1 id="splore"><a class="header" href="#splore">Splore</a></h1>
<p>Let's run the <code>splore</code> command now.</p>
<p>You will be greeted with the <code>favorites</code> view. It will be empty to start.
Whenever you select a cart, you will be able to tag it as a favorite so it
shows up here.</p>
<p><img src="overview//overview/splore_favorites.png" alt="Favorites" /></p>
<p>Pressing the <code>right</code> arrow takes you to the <em>Game Jam</em> section. These are carts
created during <em>Game Jams</em> which are time limited competitions where
participants write a game using a common theme as inspiration.</p>
<p><img src="overview//overview/splore_jam.png" alt="Game Jams" /></p>
<p>Press <code>right</code> to see a list of randomly chosen games. If you are tired of going
through the featured list, this is sometimes a good way to find something new.</p>
<p><img src="overview//overview/splore_lucky.png" alt="Lucky Draw" /></p>
<p>Press <code>right</code> again to go to a list of <code>new</code> games. These are the most recent
community uploads. The quality of the games in this list is going to be hit or
miss. Not all of them will be complete.</p>
<p><img src="overview//overview/splore_new.png" alt="New" /></p>
<p>Press <code>right</code> again to see my favorite list, the <code>featured</code> list. These are
usually very high quality games or demos that highlight what is possible using
PICO-8. My kids greatly enjoy going through this list and playing the games
that catch their eye.</p>
<p>We will return to this list shortly.</p>
<p><img src="overview//overview/splore_featured.png" alt="Featured" /></p>
<p>The next section is one that lets you search for games. This is helpful if you
have a particular game you are trying to find or want to see what the community
has made on a specific topic.</p>
<p><img src="overview//overview/splore_search.png" alt="!Search" /></p>
<p>The final section lets you browse your local files. These are the same files
you will see by running <code>ls</code> from the command prompt.</p>
<p><img src="overview//overview/splore_folders.png" alt="Folders" /></p>
<h1 id="browsing-games"><a class="header" href="#browsing-games">Browsing Games</a></h1>
<p>Let's go back to the <code>featured</code> list. Press <code>enter</code> to update the list. This
requires Internet access! It will data about a number of games.</p>
<p><img src="overview//overview/splore_featured.png" alt="Featured" /></p>
<p>If you don't have Internet access, run the <code>install_demos</code> command to install
and run a few demo carts.</p>
<p><img src="overview//overview/pico8_jelpi.png" alt="Install Demos" /></p>
<p>Use the arrow keys to navigate the list.</p>
<p><img src="overview//overview/splore_browse.png" alt="Browse" /></p>
<p>If you press <code>enter</code> on a game, you will have the option to <code>run</code> or <code>favorite</code>
the game.</p>
<p><img src="overview//overview/splore_options.png" alt="Options" /></p>
<p>Choosing <code>run</code> will start the game. Most games give show a title screen and
main menu. Some, like <code>flip knight</code> do not. Nearly all games can be controlled
using a combination of the arrow keys and the action keys (z and x). z maps to
<code>X</code> and x maps to <code>O</code>. When in doubt, just start pressing the action keys to
see what happens!</p>
<p><img src="overview//overview/splore_run.png" alt="Run" /></p>
<p>Press <code>esc</code> and choose <code>exit to splore</code> if you want to exit the game.</p>
<p><img src="overview//overview/splore_run_options.png" alt="Run Options" /></p>
<h1 id="editing-a-downloaded-game"><a class="header" href="#editing-a-downloaded-game">Editing a Downloaded Game</a></h1>
<p>As mentioned earlier, any game you run in PICO-8 can also be edited in PICO-8!
This gives you super powers. It allows you to customize any aspect of a game
you want! Let's take a peek in a cart to learn about the built-in editing
tools.</p>
<p>Run a game that looks interesting (or the Jelpi demo, if you don't have
Internet access). Once it is running, hit <code>esc</code>. If it gives you the option to
<code>exit to splore</code>, choose it and hit <code>esc</code>. Otherwise, just hit <code>esc</code>. This
should put you at a prompt. (It is the <code>&gt; </code> at the top of this next
screenshot.)</p>
<p><img src="overview//overview/splore_prompt.png" alt="Prompt" /></p>
<p>Now, hit <code>esc</code> to go into the code editor. This shows you all of the code in
the game you were running most recently.</p>
<p>The currently active tool is highlighted in the top right corner of the screen
(<code>()</code> in the example.)</p>
<p>If the game makes use of mulitple code tabs, these will appear in the top left.
The game in the screenshot only has a single code tab (labeled <code>0</code>).</p>
<p><img src="overview//overview/pico8_code.png" alt="Code Editor" /></p>
<p>To see the sprites (which include character and background graphics), click on
the face icon in the top right. It is just to the right of the <code>()</code> icon.</p>
<p>Unless you are editing the same game as me, the contents of this page will look
different.</p>
<p>PICO-8 uses a fixed pallete (those are the colors used in the sprites). This
pallete is shown in the top right. In the example, a light gray color is
selected. The current sprite is shown in the top left. Sprites are 8 pixels
wide and 8 pixels tall.</p>
<p>The available sprites are shown in the bottom pane. In this example, sprite
<code>001</code> is selected.</p>
<p>There are a number of tools just above the bottom pane. These include a pencil,
selection, movement, and paint bucket tool (among others).</p>
<p>Zoom levels, sprite pages, and sprite flags are also on this page, but those
will be discussed when and where they are used in the tutorials.</p>
<p><img src="overview//overview/pico8_sprites.png" alt="Sprite Editor" /></p>
<p>Sprites don't do us much good if they are not placed in a world. Most PICO-8
carts make use of the built-in map memory to display their sprites. The map
editor is to the right of the sprite editor. Click on it!</p>
<p><img src="overview//overview/pico8_map.png" alt="Map Editor" /></p>
<p>To the right of the map editor is the sound editor. Click on it!</p>
<p><img src="overview//overview/pico8_sound.png" alt="Sound Editor" /></p>
<p>To the right of the sound editor is the music editor. Click on it!</p>
<p><img src="overview//overview/pico8_music.png" alt="Music Editor" /></p>
<p>Those are all of the built-in tools. The <a href="https://www.lexaloffle.com/dl/docs/pico-8_manual.html">PICO-8
Manual</a> provides more
details about how to navigate and use the built-in tools. There's also a text
version included in your pico-8 installation! Look for <code>pico-8.txt</code>.</p>
<p>Making modifications to existing games is a great way to become familiar with
the tools and to express your own creativity. This is best done with simpler
titles as titles that push the limits of the console end up using advanced
techniques to cram everything into the limits of the console which makes
modifications more difficult than normal.</p>
<p>If you do end up wanting to make changes, hit <code>esc</code> to go to the prompt and
then use <code>save</code> to save the cart under a different name. Then feel free to make
the changes you want. Try them out by pressing <code>ctrl-r</code> or using the <code>run</code>
command. If you decide you don't like your changes, <code>load</code> your previously
saved version. If you like them, save them with <code>ctrl-s</code> or the `save command.</p>
<h1 id="creating-your-own-games"><a class="header" href="#creating-your-own-games">Creating Your Own Games</a></h1>
<p>Now that we have explored an exist cart. Let's try making a simple cart.</p>
<p>Get to the prompt and run <code>reboot</code>. This will reset PICO-8.</p>
<p>Hit <code>esc</code> to go the code editor and enter the following.</p>
<ul>
<li>shift-L = <code>L</code></li>
<li>shift-R = <code>R</code></li>
<li>shift-U = <code>U</code></li>
<li>shift-D = <code>D</code></li>
</ul>
<pre><code class="language-lua">function _init()
 col=7
 x=10
 y=10
end

function _update()
 if btn(L) then x-=1 end
 if btn(R) then x+=1 end
 if btn(U) then y-=1 end
 if btn(D) then y+=1 end
end

function _draw()
 cls()
 for i=1,5 do
  circfill(x,y,10-i*2,col+i)
 end
end
</code></pre>
<p>Hit <code>ctrl-r</code> to run it (or use the <code>run</code> command). You should see a
multi-colored circle that you can move around with the arrow keys.</p>
<p><img src="overview//overview/pico8_move_circle.png" alt="Move Circle" /></p>
<p>Run <code>save move_circle</code> if you want to save it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adventure-game-tutorial"><a class="header" href="#adventure-game-tutorial">Adventure Game Tutorial</a></h1>
<p>The content in this subsection comes from the &quot;PICO-8 Top-Down Adventure Game Tutorial by Dylan Bennett.</p>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLdLmU93eWisKpyk1WZywUSYAq5dkCPFIv">Original youtube playlist</a> of the tutorial series</li>
<li><a href="https://mboffin.itch.io/pico-8-top-down-adventure-game-tutorial">Official homepage</a> for the tutorial</li>
<li>Other PICO-8 tutorials from the author.</li>
</ul>
<p>It is also based on this <a href="http://www.helianthi.com/pages/pico-8-adventure/">write-up</a> of Dylan's tutorial by John Lehmann.</p>
<h2 id="preview"><a class="header" href="#preview">Preview</a></h2>
<p>Here is what you will build over the course of this tutorial.</p>
<iframe width="750px" height="680px" src="../step_12/adventuregame_bonus_step_more_tiles.html"></iframe>
<a href="ag/intro/../step_12/adventuregame_bonus_step_more_tiles.p8.png" target="_blank">Download</a>
<h2 id="other-examples"><a class="header" href="#other-examples">Other Examples</a></h2>
<p>Here are some screenshots of games others have made following this tutorial.</p>
<img src="ag/intro/./example_space_1.png" style="min-width: 400px; max-width: 800px"/>
<img src="ag/intro/./example_space_2.png" style="min-width: 400px; max-width: 800px"/>
<img src="ag/intro/./example_explorer_1.png" style="min-width: 400px; max-width: 800px"/>
<img src="ag/intro/./example_explorer_2.png" style="min-width: 400px; max-width: 800px"/>
<img src="ag/intro/./example_blob_1.png" style="min-width: 400px; max-width: 800px"/>
<p>This is a game made by the tutorial's author that is based on the framework built
in the tutorial. It adds a few additional features not covered in the tutorial, but
is a great example of what can be done with this foundation.</p>
<iframe width="750px" height="680px" src="./advent_challah.html"></iframe>
<a href="ag/intro/./advent_challah-11.p8.png" target="_blank">Download</a>
<h2 id="other-top-down-games"><a class="header" href="#other-top-down-games">Other Top-Down Games</a></h2>
<p>These are games that make use of a top-down perspective. Perhaps one of these will
give you inspiration about what you want to include in your game?</p>
<p>Puzzle Cave is a great example of a game successful enough to lead to sequels.
Here's the original. Notice that from a layout design standpoint, this isn't much
more complex than the adventure game tutorial.</p>
<iframe width="750px" height="680px" src="./21104_puzzle_cave_1.html"></iframe>
<a href="ag/intro/./21104_puzzle_cave_1.p8.png" target="_blank">Download</a>
<p>Sequels usually add more than just additional levels. They often include new item
or enemy types as this one does.</p>
<iframe width="750px" height="680px" src="./21105_puzzle_cave_2.html"></iframe>
<a href="ag/intro/./21105_puzzle_cave_2.p8.png" target="_blank">Download</a>
<p>The third installment of the game uses a different theme than the other two.</p>
<iframe width="750px" height="680px" src="./40867_puzzle_cave_3.html"></iframe>
<a href="ag/intro/./40867_puzzle_cave_3.p8.png" target="_blank">Download</a>
<p>Games are often built around a core mechanic. This is a fun little game that
more or less only has the core mechanic. As you play, think about what would
be needed to take this from a concept to a finished product.</p>
<iframe width="750px" height="680px" src="./mellow-2.html"></iframe>
<a href="ag/intro/./mellow-2.p8.png" target="_blank">Download</a>
<p>Some games keep you guessing. This one has several surprises just within its
first few moments.</p>
<iframe width="750px" height="680px" src="./47637_null.html"></iframe>
<a href="ag/intro/./47637.p8.png" target="_blank">Download</a>
<p>Here's a game that doesn't look much different than the adventure game tutorial,
but it adds an inventory, dialog, the ability to inspect items, etc.</p>
<iframe width="750px" height="680px" src="./41029_kleins_delivery.html"></iframe>
<a href="ag/intro/./41029_kleins_delivery.p8.png" target="_blank">Download</a>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-map"><a class="header" href="#the-map">The Map</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/J1wvvbVQ5zo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Start by going to the sprite editor and drawing nine sprites:</p>
<ul>
<li>grass, fancy grass, and rock</li>
<li>water, fancy water, and water rock</li>
<li>road, fancy road, and wall</li>
</ul>
<p>Here's an example of what they might look like:</p>
<img src="ag/step_01/./sprites.png" width="400"/>
<p>Toggle sprite flag 0 on the rock, the three water tiles, and the wall sprite.</p>
<img src="ag/step_01/./flag_0.png" width="400"/>
<h2 id="draw-a-map"><a class="header" href="#draw-a-map">Draw a Map</a></h2>
<p>Now that you have some sprites created, lets use them to draw a map for our game.</p>
<p>Head on over to the map tool (third icon from the left in the top bar).</p>
<img src="ag/step_01/./map_0.png"/>
<p>Once you fill the first screen, add another. To do so, you'll need to pan
the map by holding space and dragging with the mouse.</p>
<p>Here's what you might want to put on the second screen.</p>
<img src="ag/step_01/./map_1.png"/>
<p>Here's what the map looks like zoomed out with both screens populated.</p>
<img src="ag/step_01/./map_zoomed_out.png"/>
<h2 id="game-loop"><a class="header" href="#game-loop">Game Loop</a></h2>
<p>Create the main <code>game loop</code>. Put this in the <strong>0</strong> tab of the editor.</p>
<img src="ag/step_01/./tab_0.png" width="400"/>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
end

function _update()
end

function _draw()
 cls()
 draw_map()
end
</code></pre>
<h2 id="map-code"><a class="header" href="#map-code">Map Code</a></h2>
<p>Create the code that draws the map. Click the <strong>+</strong> button to create tab <strong>1</strong> and put this code in that tab.</p>
<pre><code class="language-lua">--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 map(0,0,0,0,128,64)
end
</code></pre>
<h2 id="end-result"><a class="header" href="#end-result">End Result</a></h2>
<iframe width="750px" height="680px" src="./adventuregame_step_01.html"></iframe>
<a href="ag/step_01/./adventuregame_step_01.p8.png" target="_blank">Download</a>
<h2 id="source-code"><a class="header" href="#source-code">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
end

function _update()
end

function _draw()
 cls()
 draw_map()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 map(0,0,0,0,128,64)
end

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-player"><a class="header" href="#the-player">The Player</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/cam1jKG1hOY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Draw a sprite for the player.</p>
<img src="ag/step_02/./player_sprite.png"/>
<p>Click on the <strong>+</strong> in the code editor to creat tab <strong>2</strong>. This will be used for the code related to the player.</p>
<pre><code class="language-lua">-- player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end
</code></pre>
<p>Call these functions from the <code>game loop</code> tab (tab <strong>0</strong>).</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
end

function _draw()
 cls()
 draw_map()
 draw_player()
end
</code></pre>
<h2 id="end-result-1"><a class="header" href="#end-result-1">End Result</a></h2>
<p>Save your changes with <strong>ctrl+s</strong>. Run them with <strong>ctrl+r</strong>. You should see your
player displayed on the map. The player cannot move around yet. We'll add some
movement to the player in the next section.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_02.html"></iframe>
<a href="ag/step_02/./adventuregame_step_02.p8.png" target="_blank">Download</a>
<h2 id="source-code-1"><a class="header" href="#source-code-1">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
end

function _draw()
 cls()
 draw_map()
 draw_player()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 map(0,0,0,0,128,64)
end

--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end


</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="movement"><a class="header" href="#movement">Movement</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/T9z6RPvyypE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Create a sound effect for bumping into an obstacle.</p>
<p>Do this by going to the sound editor. Change the settings of the sounds to
match those you see in the screenshot. Press <code>space</code> to play your sound to test
it out.</p>
<img src="ag/step_03/./sound_bump.png" style="min_width: 400px; max-width: 800px"/>
<p>Add two functions <code>is_tile</code> and <code>can_move</code> to the map code tab.</p>
<pre><code class="language-lua">function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall, x, y)
end
</code></pre>
<p>Add a function for moving the player to the player code tab.</p>
<p><em>Note:</em> to get the arrow characters, use <strong>shift+L</strong>, <strong>shift+R</strong>, <strong>shift+U</strong>, <strong>shift+D</strong>.</p>
<pre><code class="language-lua">function move_player()
 newx=p.x
 newy=p.y

 if (btnp(L)) newx-=1
 if (btnp(R)) newx+=1
 if (btnp(U)) newy-=1
 if (btnp(D)) newy+=1

 if can_move(newx,newy) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end

end
</code></pre>
<p>Call this function from function update in the game loop tab.</p>
<pre><code class="language-lua">function _update()
 move_player()
end
</code></pre>
<h2 id="end-result-2"><a class="header" href="#end-result-2">End Result</a></h2>
<p>Save your changes with <strong>ctrl+s</strong>. Run them with <strong>ctrl+r</strong>. You should now be able
to move your player around the screen, but once you go off of the screen, you are
no longer able to see them. In the next section, we will make the camera follow
the player so we can explore more of the map.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_03.html"></iframe>
<a href="ag/step_03/./adventuregame_step_03.p8.png" target="_blank">Download</a>
<h2 id="source-code-2"><a class="header" href="#source-code-2">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end


--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camera"><a class="header" href="#camera">Camera</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DE-J_n-Y-cU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Have the camera follow the player around the map.</p>
<p>Add code to set the camera to the <code>draw_map</code> function in the map code tab.</p>
<ul>
<li>divide the player's x and y coordinates by 16</li>
<li>round down</li>
<li>multiply by 16</li>
<li>convert mapx, mapy to a pixel coordinate by multiplying by 8</li>
</ul>
<pre><code class="language-lua">function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end
</code></pre>
<h2 id="end-result-3"><a class="header" href="#end-result-3">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. The camera should now
follow your character from screen to screen. Wondering a world without being able
to interact with it isn't all that interesting so lets add some things the player
can pick up in the next section.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_04.html"></iframe>
<a href="ag/step_04/./adventuregame_step_04.p8.png" target="_blank">Download</a>
<h2 id="source-code-3"><a class="header" href="#source-code-3">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end


--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keys"><a class="header" href="#keys">Keys</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8RXnQYXufB8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>We are going to add items for our player to interact with in our world. One
will be a key they can pick up. The other will be a chest they can open.</p>
<p>You will need to draw two sprites for each of them.</p>
<p>For the key, the first will be what the key looks like when it can be picked
up. The second will be what the tile should look like after the key has been
picked up. In the example, it looks just like the grass tile.</p>
<p>You may ask, why not just reuse the grass tile? Why draw a duplicate? The
reason is that it greatly simplifies the code we have to write to handle
picking up keys.</p>
<p>Whenever the player interacts with a key tile in our world, we will simply
replace the sprite that received the interaction with the sprite immediately to
the right of it in the sprite sheet.</p>
<p>This means that it is <strong>very</strong> important that the tile without the key be
immediately to the right of the tile with the key!</p>
<p>Go ahead a draw the two key sprites now. You will want to set sprite flag 1 on
the key (but not the tile without the key). Sprite flag 1 is what we use to
determine if the player can interact with a tile.</p>
<p><img src="ag/step_05/./key.png" alt="Key" /></p>
<p><img src="ag/step_05/./key_picked_up.png" alt="Picked Up Key" /></p>
<p>For the chest, we need a sprite showing a closed chest and one showing an open
one. The closed chest needs to have sprite flag 1 set on it.</p>
<p>Just as with the key sprites, it is <strong>very</strong> important that the closed chest
sprite be immediately to the right of the open chest sprite.</p>
<p><img src="ag/step_05/./chest.png" alt="Chest" /></p>
<p><img src="ag/step_05/./chest_opened.png" alt="Chest Opened" /></p>
<p>Make a sound effect for the pick-up key sound.</p>
<p>Go to the sound editor. Switch from sound <code>00</code> to sound <code>01</code>. Try replicating
what is shown in the screenshot or feel free to make up your own sound.</p>
<p><img src="ag/step_05/./pick_up_sound.png" alt="Pick Up Sound" /></p>
<p>Now we need to add the code that allows the player to pick up keys. Interacting
with either the key on the ground or the chest will give the player a key.</p>
<p>Add two functions, <code>swap_tile</code> and <code>get_key</code>, to the map code tab.</p>
<pre><code class="language-lua">function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end
</code></pre>
<p>The <code>swap_tile</code> function replaces the current tile with the tile immediately to
the right of it in the sprite sheet. This is why we had to draw the key and
chest variants where we did.</p>
<p>The <code>get_key</code> function increases the count of the keys the player is carrying
by one, swaps the tile to show that the player successfully interacted with the
tile, and plays a sound to give an audible indication of the action.</p>
<p>Just adding these two functions changes nothing in our code. We have to call
one of them from somewhere.</p>
<p>Add a function called <code>interact</code> to the player code tab.</p>
<pre><code class="language-lua">function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 end
end
</code></pre>
<p>This function checks to see if the tile is a key tile. If it is, it calls the
<code>get_key</code> function to pick up the key.</p>
<p>Now call this function from the <code>move_player</code> function.</p>
<pre><code class="language-lua">function move_player()
 newx=p.x
 newy=p.y

 if (btnp(L)) newx-=1
 if (btnp(R)) newx+=1
 if (btnp(U)) newy-=1
 if (btnp(D)) newy+=1

 interact(newx,newy)
</code></pre>
<h2 id="end-result-4"><a class="header" href="#end-result-4">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. You should now be
able to have your character pick up keys, but you will not be able to see how
many keys your character is holding. We will fix that in the next section.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_05.html"></iframe>
<a href="ag/step_05/./adventuregame_step_05.p8.png" target="_blank">Download</a>
<h2 id="source-code-4"><a class="header" href="#source-code-4">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 end
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inventory"><a class="header" href="#inventory">Inventory</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ZF8exnHMQRw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>When the player holds down the <code>X</code> key we'll show how many keys the player has
in their inventory.</p>
<p>Create a new tab called inventory code. It shoudl be tab <code>3</code>. Add a function
called <code>show_inventory</code> to it.</p>
<pre><code class="language-lua">function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8

 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
</code></pre>
<p>Then call this function from the <code>_draw</code> function.
You can use shift-x to get the <code>X</code> glyph.</p>
<pre><code class="language-lua">function _draw()
 cls()
 draw_map()
 draw_player()
 if (btn(❎)) show_inventory()
end
</code></pre>
<h2 id="end-result-5"><a class="header" href="#end-result-5">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. You should now be able
to pick up a key and then press <code>X</code> to see how many keys the player has in their
inventory. Next, lets add a way for the player to use the keys they collect.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_06.html"></iframe>
<a href="ag/step_06/./adventuregame_step_06.p8.png" target="_blank">Download</a>
<h2 id="source-code-5"><a class="header" href="#source-code-5">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
 if (btn(_)) show_inventory()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="doors"><a class="header" href="#doors">Doors</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/9EiXQxfK05I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>What good are keys if you cannot do anything with them?</p>
<p>Let's fix this by adding doors that the player can open with their keys. First draw a pair of sprites: an closed and an opened door. Just like with the key and chest sprites, be sure to put them right next to each other. This allows us to use the <code>swap_tile</code> function to open a door.</p>
<p><img src="ag/step_07/./door_closed.png" alt="Closed Door" /></p>
<p><img src="ag/step_07/./door_opened.png" alt="Opened Door" /></p>
<p>Add a sound effect for opening a door. This should be sound <code>02</code>. Replicate
what is in the screenshot or create your own custom door opening sound.</p>
<p><img src="ag/step_07/./open_door_sound.png" alt="Open Door Sound" /></p>
<p>Add a function <code>open_door</code> to open the door to the map code tab.</p>
<pre><code class="language-lua">function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
</code></pre>
<p>This function gets called in the interact function.</p>
<pre><code class="language-lua">function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
</code></pre>
<h2 id="end-result-6"><a class="header" href="#end-result-6">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. You should now be
able to pick up a key and use it to unlock a door.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_07.html"></iframe>
<a href="ag/step_07/./adventuregame_step_07.p8.png" target="_blank">Download</a>
<h2 id="source-code-6"><a class="header" href="#source-code-6">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
 if (btn(_)) show_inventory()
end


--&gt;8
--map code

function map_setup()
 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="animate-tiles"><a class="header" href="#animate-tiles">Animate Tiles</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/MkXeXYPF2pw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>In this step we add animated tiles. Animated tiles bring the map to life. Here we'll use them to make a spike trap that the player has to navigate through.</p>
<p>Create a pair of sprites, one for the spikes up and one with the spikes down. The animation will have cause the two sprites to flip between each other.</p>
<p>The tile with spikes up should have two flags set: <strong>flag 3</strong> (anim1, or step one of the animation) and <strong>flag 6</strong> (lose), which will cause the player to lose if they step on them.</p>
<img src="ag/step_08/./spikes_up.png" style="min-width: 400px; max-width: 800px"/>
<p>The tile with spikes down should have one flag set: <strong>flag 4</strong>, (anim2, step 2 of the animation).</p>
<img src="ag/step_08/./spikes_down.png" style="min-width: 400px; max-width: 800px"/>
<p>Add two variables to the <code>map_setup</code> function in the map code tab.</p>
<pre><code class="language-lua">function map_setup()
 --timers
 timer=0
 anim_time=30 -- 30 = 1 second
</code></pre>
<p>Add a new function <code>unswap_tile</code> to the map code tab. Note that this function is nearly the same as <code>swap_tile</code> and so you can use copy paste to write it.</p>
<pre><code class="language-lua">function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end
</code></pre>
<p>Add a new tab, animation code. Add a new function <code>toggle_tiles</code> to this tab.</p>
<pre><code class="language-lua">function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y))then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
</code></pre>
<p>Add a new function called <code>update_map</code> to the map code tab.</p>
<pre><code class="language-lua">function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end
</code></pre>
<p>Finally, call the <code>update_map</code> function from the <code>_update</code> function in the <code>game loop</code> (<strong>tab 0</strong>).</p>
<pre><code class="language-lua">function _update()
 update_map()
 move_player()
end
</code></pre>
<h2 id="end-result-7"><a class="header" href="#end-result-7">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. Your animated tiles
should change about once every second, but there still isn't a way to win the
game. Lets add that next.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_08.html"></iframe>
<a href="ag/step_08/./adventuregame_step_08.p8.png" target="_blank">Download</a>
<h2 id="source-code-7"><a class="header" href="#source-code-7">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
end

function _update()
 update_map()
 move_player()
end

function _draw()
 cls()
 draw_map()
 draw_player()
 if (btn(_)) show_inventory()
end


--&gt;8
--map code

function map_setup()
 --timers
 timer=0
 anim_time=30 --30 = 1 second

 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
--&gt;8
--animation code

function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y)) then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="winning-and-losing"><a class="header" href="#winning-and-losing">Winning and Losing</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aKnlApA_42U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Add a new sprite that the player has to move over to win the game.</p>
<img src="ag/step_09/./target_sprite.png" style="min-width: 400px; max-width: 800px"/>
<p>Set the last flag on this sprite. This is what the game will use to know the player
has won the game.</p>
<p>Add <code>game_win</code> and <code>game_over</code> to <code>_init</code> in the <code>game loop</code> <strong>tab 0</strong>.</p>
<pre><code class="language-lua">function _init()
 map_setup()
 make_player()

 game_win=false
 game_over=false
end
</code></pre>
<p>Add a new code tab to hold the win/lose code. This will be <strong>tab 5</strong>.</p>
<p>In this tab, add two new functions: <code>check_win_lose</code>, <code>draw_win_lose</code></p>
<pre><code class="language-lua">-- win/lose code

function check_win_lose()
 if (is_tile(win,p.x,p.y)) then
  game_win=true
  game_over=true
 elseif (is_tile(lose,p.x,p.y)) then
  game_win=false
  game_over=true
 end
end

function draw_win_lose()
 camera()
 if (game_win) then
  print(&quot;S you win! S&quot;,37,64,7)
 else
  print(&quot;game over!&quot;,38,64,7)
 end
end
</code></pre>
<p>Change <code>_update</code> to only run if not <code>game_over</code> and call <code>check_win_lose</code></p>
<pre><code class="language-lua">function _update()
 update_map()
 move_player()
 if (not game_over) then
  update_map()
  move_player()
  check_win_lose()
 end
end
</code></pre>
<p>Change <code>_draw</code> to only draw if not <code>game_over</code> else <code>draw_win_lose</code></p>
<pre><code class="language-lua">function _draw()
 cls()
 draw_map()
 draw_player()
 if (btn(X)) show_inventory()
 if (not game_over) then
  draw_map()
  draw_player()
  if (btn(X)) show_inventory()
 else
  draw_win_lose()
 end
end
</code></pre>
<h2 id="end-result-8"><a class="header" href="#end-result-8">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. You should now be able
to walk into spikes to lose and walk into the target to win. Next, we will add a way
to easily reset the game.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_09.html"></iframe>
<a href="ag/step_09/./adventuregame_step_09.p8.png" target="_blank">Download</a>
<h2 id="source-code-8"><a class="header" href="#source-code-8">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--game loop

function _init()
 map_setup()
 make_player()
 
 game_win=false
 game_over=false
end

function _update()
 if (not game_over) then
  update_map()
  move_player()
  check_win_lose()
 end
end

function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  if (btn(_)) show_inventory()
 else
  draw_win_lose()
 end
end


--&gt;8
--map code

function map_setup()
 --timers
 timer=0
 anim_time=30 --30 = 1 second

 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
--&gt;8
--animation code

function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y)) then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
--&gt;8
--win/lose code

function check_win_lose()
 if (is_tile(win,p.x,p.y)) then
  game_win=true
  game_over=true
 elseif (is_tile(lose,p.x,p.y)) then
  game_win=false
  game_over=true
 end
end

function draw_win_lose()
 camera()
 if (game_win) then
  print(&quot;_ you win! _&quot;,37,64,7)
 else
  print(&quot;game over! :(&quot;,38,64,7)  
 end
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trying-again"><a class="header" href="#trying-again">Trying Again</a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/2UDThoTpxOY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Add a way for the player to restart the game when they win or lose.</p>
<p>Add the following else condition to the <code>_update</code> function.</p>
<pre><code class="language-lua">else
 if (btnp(X)) extcmd(&quot;reset&quot;)
</code></pre>
<p>Add the following code to the <code>draw_win_lose</code> function</p>
<pre><code class="language-lua">print(&quot;press X to play again&quot;,20,72,5)
</code></pre>
<h2 id="end-result-9"><a class="header" href="#end-result-9">End Result</a></h2>
<p>Save your changes with <strong>ctrl+S</strong>. Run them with <strong>ctrl+R</strong>. You should now be able
to have reset the game after winning or losing.</p>
<p>Congratualations! This marks the point where you have a fully functional game!</p>
<p>You have an interactive world with a goal, obstacles to achieving that goal, the
ability for the player to win or lose, and the ability to reset the game after
a game over event.</p>
<p>Next, we will add text to the world to enable you to provide the player more
guidance on what to do in the game.</p>
<iframe width="750px" height="680px" src="./adventuregame_step_10.html"></iframe>
<a href="ag/step_10/./adventuregame_step_10.p8.png" target="_blank">Download</a>
<h2 id="source-code-9"><a class="header" href="#source-code-9">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--adventure game
--by dylan

function _init()
 map_setup()
 make_player()
 
 game_win=false
 game_over=false
end

function _update()
 if (not game_over) then
  update_map()
  move_player()
  check_win_lose()
 else
  if (btnp(_)) extcmd(&quot;reset&quot;)
 end
end

function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  if (btn(_)) show_inventory()
 else
  draw_win_lose()
 end
end


--&gt;8
--map code

function map_setup()
 --timers
 timer=0
 anim_time=30 --30 = 1 second

 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 lose=6
 win=7
end

function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
--&gt;8
--animation code

function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y)) then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
--&gt;8
--win/lose code

function check_win_lose()
 if (is_tile(win,p.x,p.y)) then
  game_win=true
  game_over=true
 elseif (is_tile(lose,p.x,p.y)) then
  game_win=false
  game_over=true
 end
end

function draw_win_lose()
 camera()
 if (game_win) then
  print(&quot;_ you win! _&quot;,37,64,7)
 else
  print(&quot;game over! :(&quot;,38,64,7)  
 end
 print(&quot;press _ to play again&quot;,20,72,5)
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bonus-step-adding-text"><a class="header" href="#bonus-step-adding-text">Bonus Step: Adding Text</a></h1>
<p>This step will be a bit more involved than the previous steps. If you have
made it to this step, you will definitely be able to complete it. Just take
it slow and don't rush.</p>
<p>Create a sign sprite.</p>
<p><img src="ag/step_11/./sign.png" alt="Sign" /></p>
<p>Place two of them. If you don't place them at x=1,y=3 and x=7,y=3 you will need to update the code to reflect where the signs are placed in your world.</p>
<p><img src="ag/step_11/./sign1.png" alt="Sign1" /></p>
<p><img src="ag/step_11/./sign2.png" alt="Sign2" /></p>
<p>Add <code>text=5</code> to the <code>tile settings</code> in <code>map_setup</code>.  We are going to use this
to trigger the display of text to the user.</p>
<p><img src="ag/step_11/./text_flag.png" alt="Text Flag" /></p>
<p>Now, let's add some code to make use of this tile type.</p>
<p>In tab <code>0</code>, add a call to <code>text_setup</code></p>
<pre><code class="language-lua">function _init()
 map_setup()
 text_setup()
 make_player()
 
</code></pre>
<p>Modify the <code>_update</code> call to only update the game state if there is no active text displayed.</p>
<pre><code class="language-lua">function _update()
 if (not game_over) then
  if (not active_text) then
   update_map()
   move_player()
   check_win_lose()
  end
</code></pre>
<p>In <code>_draw</code>, call <code>draw_text</code> after drawing the map and the player.</p>
<pre><code class="language-lua">function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  draw_text()
</code></pre>
<p>In the player interaction code, tab <code>2</code>, add a check for the text tile type.</p>
<pre><code class="language-lua">function interact(x,y)
 if (is_tile(text,x,y)) then
  active_text=get_text(x,y)
 end

</code></pre>
<p>Add a new tab. This will be tab <code>6</code>. We will put the text related code here.</p>
<pre><code class="language-lua">--text code

function text_setup()
 texts={}
 add_text(1,3,&quot;first sign!&quot;)
 add_text(7,3,&quot;oh, look!\na sign!&quot;)
end

function add_text(x,y,message)
 texts[x+y*128]=message
end

function get_text(x,y)
 return texts[x+y*128]
end

function draw_text()
 if (active_text) then
  textx=mapx*8+4
  texty=mapy*8+48
  
  rectfill(textx,texty,textx+119,texty+31,7)
  print(active_text,textx+4,texty+4,1)
  print(&quot;_ to close&quot;,textx+4,texty+23,6)
 end
 
 if (btnp(_)) active_text=nil
end
</code></pre>
<p>Save your game and run it. With any luck, you should be able to walk up to and read each sign.</p>
<p><img src="ag/step_11/./sign1_shown.png" alt="Sign1 Shown" /></p>
<p><img src="ag/step_11/./sign2_shown.png" alt="Sign2 Shown" /></p>
<p>This opens up a world of possibilities. It allows to add Non-Player Characters
(NPCs) that can speak with your character. Signs can provide instructions or
warnings. You are able to tell your character's back story through dialog or notes or other narrative devices.</p>
<h1 id="result"><a class="header" href="#result">Result</a></h1>
<iframe width="750px" height="680px" src="./adventuregame_bonus_step_text.html"></iframe>
<a href="ag/step_11/./adventuregame_bonus_step_text.p8.png" target="_blank">Download</a>
<h2 id="source-code-10"><a class="header" href="#source-code-10">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--adventure game
--by dylan

function _init()
 map_setup()
 text_setup()
 make_player()
 
 game_win=false
 game_over=false
end

function _update()
 if (not game_over) then
  if (not active_text) then
   update_map()
   move_player()
   check_win_lose()
  end
 else
  if (btnp(_)) extcmd(&quot;reset&quot;)
 end
end

function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  draw_text()
  if (btn(_)) show_inventory()
 else
  draw_win_lose()
 end
end


--&gt;8
--map code

function map_setup()
 --timers
 timer=0
 anim_time=30 --30 = 1 second

 --map tile settings
 wall=0
 key=1
 door=2
 anim1=3
 anim2=4
 text=5
 lose=6
 win=7
end

function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 has_flag=fget(tile,tile_type)
 return has_flag
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(text,x,y)) then
  active_text=get_text(x,y)
 end

 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+24,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
end
--&gt;8
--animation code

function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y)) then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
--&gt;8
--win/lose code

function check_win_lose()
 if (is_tile(win,p.x,p.y)) then
  game_win=true
  game_over=true
 elseif (is_tile(lose,p.x,p.y)) then
  game_win=false
  game_over=true
 end
end

function draw_win_lose()
 camera()
 if (game_win) then
  print(&quot;_ you win! _&quot;,37,64,7)
 else
  print(&quot;game over! :(&quot;,38,64,7)  
 end
 print(&quot;press _ to play again&quot;,20,72,5)
end
--&gt;8
--text code

function text_setup()
 texts={}
 add_text(1,3,&quot;first sign!&quot;)
 add_text(7,3,&quot;oh, look!\na sign!&quot;)
end

function add_text(x,y,message)
 texts[x+y*128]=message
end

function get_text(x,y)
 return texts[x+y*128]
end

function draw_text()
 if (active_text) then
  textx=mapx*8+4
  texty=mapy*8+48
  
  rectfill(textx,texty,textx+119,texty+31,7)
  print(active_text,textx+4,texty+4,1)
  print(&quot;_ to close&quot;,textx+4,texty+23,6)
 end
 
 if (btnp(_)) active_text=nil
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bonus-step-unlimited-sprite-types"><a class="header" href="#bonus-step-unlimited-sprite-types">Bonus Step: Unlimited Sprite Types</a></h1>
<p>We have been using sprite flags to differentiate between the different sprite
types. This limits us to a maximum of 8 sprite types.</p>
<p>To overcome this limitation and support an unlimited number of sprite types,
we are going to switch from using sprite flags to explicitly enumerating all
of the sprites of each type.</p>
<p>In <code>map_setup</code>, we currently have this mapping of sprite types to their flags.</p>
<pre><code class="language-lua">wall=0
key=1
door=2
anim1=3
anim2=4
lose=6
win=7
</code></pre>
<p>Change each of these to be a list of all of the sprite numbers for each sprite
of that type. If you very closely followed along to this point, you should be
able to copy these values. If you were more casual in where you placed each
sprite type, your numbers will be different. Check each of these values against
your setup.</p>
<pre><code class="language-lua">wall={18,32,33,34,36,37,50,52}
key={20,36}
door={52}
anim1={23}
anim2={24}
lose={23}
win={7}
</code></pre>
<p>Replace the call to <code>fget</code> in <code>is_tile</code> in tab <code>1</code> with this:</p>
<pre><code class="language-lua">for i=1,#tile_type do
 if (tile == tile_type[i]) return true
end
return false
</code></pre>
<p>Once you have made these changes, hit <code>ctrl-s</code> to save your game and <code>ctrl-r</code>
to run it.</p>
<p>You will want to test to verify that all of the sprite types work. That means
you will want to:</p>
<ul>
<li>Attempt to walk into all wall tile types (e.g. water, wall)</li>
<li>Pick up all key tile types (e.g. the key and the chest)</li>
<li>Step on all spike tile types</li>
<li>Walk on all non-wall types (e.g. grass, stone)</li>
</ul>
<p>If a tile isn't behaving as you expect, double check that the number for the
sprite is in the correct list in <code>map_setup</code>.</p>
<h1 id="new-tile-type"><a class="header" href="#new-tile-type">New Tile Type</a></h1>
<p>Once you have verified all sprite types work, lets make use of the added
flexibility by adding a new sprite type.</p>
<p>We are going to change the chest so it gives us gold instead of a key. Modify
<code>map_setup</code>. Remove sprite <code>36</code> (the chest) from the key list.</p>
<pre><code class="language-lua">key={20}
</code></pre>
<p>and add it to a newly created <code>gold</code> list.</p>
<pre><code class="language-lua">gold={36}
</code></pre>
<p>Picking up gold does us no good, if we don't keep track of it. Lets modify
<code>make_player</code> in tab <code>2</code>. Put this at the end of the function.</p>
<pre><code class="language-lua">p.gold=0
</code></pre>
<p>With a place to store it, we can add a function to allow us to get it. Copy
<code>get_key</code> in tab <code>1</code> and modify it to create <code>get_gold</code>.</p>
<pre><code class="language-lua">function get_gold(x,y)
 p.gold+=5
 swap_tile(x,y)
 sfx(1)
end
</code></pre>
<pre><code class="language-lua">function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and...
  open_door(x,y)
 elseif (is_tile(gold,x,y))
  get_gold(x,y)
 end
</code></pre>
<p>Now we just need to update <code>show_inventory</code> in tab <code>3</code> to show the player how
much gold they have. Start by making the rectangle <code>6</code> pixels taller by changing
<code>invy+24</code> to <code>invy+30</code>. Then add this line to the end of the function.</p>
<pre><code class="language-lua">print(&quot;gold &quot;, .p.gold,invx+12, invy+20,9)
</code></pre>
<p>Save and run the game. The gold in the player's inventory should start out at
<code>0</code>. Open the chest and show the inventory. It should show <code>5</code> gold.</p>
<p>If you made it to this point, congratulations! You now have the ability to add
an unlimited number of sprite types. Here are just a few of the possibilities:</p>
<ul>
<li>Chests that hold specific items</li>
<li>Chests that hold a variable amount of gold</li>
<li>Keys that only open certain chests or doors</li>
<li>Items needed to complete quests</li>
<li>etc</li>
</ul>
<h1 id="result-1"><a class="header" href="#result-1">Result</a></h1>
<iframe width="750px" height="680px" src="./adventuregame_bonus_step_more_tiles.html"></iframe>
<a href="ag/step_12/./adventuregame_bonus_step_more_tiles.p8.png" target="_blank">Download</a>
<h2 id="source-code-11"><a class="header" href="#source-code-11">Source Code</a></h2>
<p>Here is the full source code for this step. If you want your code to match what
is shown in the tutorial, everything after a <code>--&gt;8</code> line should go in a new
tab. This is not necessary, but failure to do so will make your code harder to
navigate, reason about, and edit.</p>
<p><strong>Note:</strong> The tool used to extract the full code listings does not properly
handle PICO-8's glyph characters. All glyph characters are replaced with an
<code>_</code>. You will need to manually replace them with the correct character.</p>
<pre><code class="language-lua">--adventure game
--by dylan

function _init()
 map_setup()
 make_player()
 
 game_win=false
 game_over=false
end

function _update()
 if (not game_over) then
  update_map()
  move_player()
  check_win_lose()
 else
  if (btnp(_)) extcmd(&quot;reset&quot;)
 end
end

function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  if (btn(_)) show_inventory()
 else
  draw_win_lose()
 end
end


--&gt;8
--map code

function map_setup()
 --timers
 timer=0
 anim_time=30 --30 = 1 second

 --map tile settings
 wall={18,32,33,34,36,37,50,52}
 key={20}
 door={52}
 anim1={23}
 anim2={24}
 lose={23}
 win={7}
 gold={36}
end

function update_map()
 if (timer&lt;0) then
  toggle_tiles()
  timer=anim_time
 end
 timer-=1
end

function draw_map()
 mapx=flr(p.x/16)*16
 mapy=flr(p.y/16)*16
 camera(mapx*8,mapy*8)

 map(0,0,0,0,128,64)
end

function is_tile(tile_type,x,y)
 tile=mget(x,y)
 for i=1,#tile_type do
  if (tile==tile_type[i]) return true
 end
 return false
end

function can_move(x,y)
 return not is_tile(wall,x,y)
end

function swap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile+1)
end

function unswap_tile(x,y)
 tile=mget(x,y)
 mset(x,y,tile-1)
end

function get_key(x,y)
 p.keys+=1
 swap_tile(x,y)
 sfx(1)
end

function open_door(x,y)
 p.keys-=1
 swap_tile(x,y)
 sfx(2)
end

function get_gold(x,y)
 p.gold+=5
 swap_tile(x,y)
 sfx(1)
end
--&gt;8
--player code

function make_player()
 p={}
 p.x=3
 p.y=2
 p.sprite=1
 p.keys=0
 p.gold=0
end

function draw_player()
 spr(p.sprite,p.x*8,p.y*8)
end

function move_player()
 newx=p.x
 newy=p.y
 
 if (btnp(_)) newx-=1
 if (btnp(_)) newx+=1
 if (btnp(_)) newy-=1
 if (btnp(_)) newy+=1
 
 interact(newx,newy)
 
 if (can_move(newx,newy)) then
  p.x=mid(0,newx,127)
  p.y=mid(0,newy,63)
 else
  sfx(0)
 end
end

function interact(x,y)
 if (is_tile(key,x,y)) then
  get_key(x,y)
 elseif (is_tile(door,x,y) and p.keys&gt;0) then
  open_door(x,y)
 elseif (is_tile(gold,x,y)) then
  get_gold(x,y)
 end
end
--&gt;8
--inventory code

function show_inventory()
 invx=mapx*8+40
 invy=mapy*8+8
 
 rectfill(invx,invy,invx+48,invy+30,0)
 print(&quot;inventory&quot;,invx+7,invy+4,7)
 print(&quot;keys &quot;..p.keys,invx+12,invy+14,9)
 print(&quot;gold &quot;..p.gold,invx+12,invy+20,9)
end
--&gt;8
--animation code

function toggle_tiles()
 for x=mapx,mapx+15 do
  for y=mapy,mapy+15 do
   if (is_tile(anim1,x,y)) then
    swap_tile(x,y)
    sfx(3)
   elseif (is_tile(anim2,x,y)) then
    unswap_tile(x,y)
    sfx(3)
   end
  end
 end
end
--&gt;8
--win/lose code

function check_win_lose()
 if (is_tile(win,p.x,p.y)) then
  game_win=true
  game_over=true
 elseif (is_tile(lose,p.x,p.y)) then
  game_win=false
  game_over=true
 end
end

function draw_win_lose()
 camera()
 if (game_win) then
  print(&quot;_ you win! _&quot;,37,64,7)
 else
  print(&quot;game over! :(&quot;,38,64,7)  
 end
 print(&quot;press _ to play again&quot;,20,72,5)
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-space-shooter-in-16-steps"><a class="header" href="#a-space-shooter-in-16-steps">A Space Shooter in 16 Steps</a></h1>
<p><a href="https://ztiromoritz.github.io/pico-8-shooter/">This is a fun take</a> on a tutorial format. It shows how to make a spaceshooter, but instead of creating videos or a written tutorial, it uses a series of 16 animated images.</p>
<p>Local versions of the origianl images are inlined below. Each of the nested sections is devoted to a single image. The image is dispalyed at the top of each page. If you want to pause or otherwise control the playback, press the play button to switch to playing a video version of the same content.</p>
<p>If all of that sounds like too much work, there are written instructions on each page so you don't have to mess around with the vidoes, if you don't want to.</p>
<p><img src="ss/intro/../step_01/tut_1.gif" alt="..." />
<img src="ss/intro/../step_02/tut_2.gif" alt="..." />
<img src="ss/intro/../step_03/tut_3.gif" alt="..." />
<img src="ss/intro/../step_04/tut_4.gif" alt="..." />
<img src="ss/intro/../step_05/tut_5.gif" alt="..." />
<img src="ss/intro/../step_06/tut_6.gif" alt="..." />
<img src="ss/intro/../step_07/tut_7.gif" alt="..." />
<img src="ss/intro/../step_08/tut_8.gif" alt="..." />
<img src="ss/intro/../step_09/tut_9.gif" alt="..." />
<img src="ss/intro/../step_10/tut_10.gif" alt="..." />
<img src="ss/intro/../step_11/tut_11.gif" alt="..." />
<img src="ss/intro/../step_12/tut_12.gif" alt="..." />
<img src="ss/intro/../step_13/tut_13.gif" alt="..." />
<img src="ss/intro/../step_14/tut_14.gif" alt="..." />
<img src="ss/intro/../step_15/tut_15.gif" alt="..." />
<img src="ss/intro/../step_16/tut_16.gif" alt="..." /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="01-draw-ship-on-screen"><a class="header" href="#01-draw-ship-on-screen">01. Draw ship on screen</a></h1>
<video controls width="512" poster="./tut_1.gif">
    <source src="./tut_1.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_01/./tut_1.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_1.gif">Original Source</a>)</p>
<p>Let's start by creating a ship sprite in the sprite editor.</p>
<div><img src="ss/step_01/./ship.png" width="512"/></div>
<p>Go to the code editor and enter this code in tab <strong>0</strong>.</p>
<p>Now let's draw the ship on the screen!</p>
<pre><code class="language-lua">function _init()
 ship={x=60,y=60}
end

function _draw()
 spr(1,ship.x,ship.y}
end
</code></pre>
<p>The <code>_init</code> function creates a table to hold properies for the ship. We will
start with its <code>x</code> and <code>y</code> coordinates. This is how we will know where to draw
the ship on the screen.</p>
<p>The <code>_draw</code> function displays sprite <code>1</code> on the screen at the <code>x</code> and <code>y</code>
coordinates in the <code>ship</code> table. <strong>Note:</strong> if your ship is not in the sprite
sheet at location <code>001</code> (as shown in the screenshot above), you will need to
change the first parameter to <code>spr</code> to match.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="02-animate-propulsion"><a class="header" href="#02-animate-propulsion">02. Animate Propulsion</a></h1>
<video controls width="512" poster="./tut_2.gif">
    <source src="./tut_2.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_02/./tut_2.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_2.gif">Original Source</a>)</p>
<p>In this step, we will create a ship propulsion animation.</p>
<p>Start by modifying the ship we drew in the last step.</p>
<p><strong>Tip:</strong> Press up to shift the ship up a pixel. This will give you the space
you need to add the jetstream pixel without having to redraw the ship!</p>
<!--
Not sure why these img tags need to be wrapped in divs.
They don't render otherwise...
-->
<div><img src="ss/step_02/modified_ship.png" width=512" /></div>
<p>Now create a second ship where the jetstream pixels swap.</p>
<div><img src="ss/step_02/./propulsion.png" width=512" /></div>
<p>Enter this code on tab <strong>0</strong> in the code editor.</p>
<pre><code class="language-lua">t=0
function _init()
 ship={sp=1,x=60,y=60}
end

function_update()
 t=t+1
 if(t%6&lt;3) then
  ship.sp=1
 else
  ship.sp=2
 end
end

function _draw()
 cls()
 spr(ship.sp,ship.x,ship.y)
end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. A ship will appear with an animated jetstream!</p>
<div><img src="ss/step_02/./anim.gif" width=512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="03-basic-ship-movement"><a class="header" href="#03-basic-ship-movement">03. Basic Ship Movement</a></h1>
<video controls width="512" poster="tut_3.gif">
    <source src="./tut_3.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_03/./tut_3.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_3.gif">Original Source</a>)</p>
<p>In this step, we will add code to move the ship around the screen.</p>
<p>At the end of the <code>_update</code> function, add an <code>if</code> statement for each arrow key.</p>
<p><strong>Tip:</strong> After typing the first <code>if</code> statement, hit <code>ctrl-d</code> to duplicate the
first line. Then edit the new line. This will save you some typing.</p>
<pre><code class="language-lua">if btn(L) then ship.x-=1 end
if btn(R) then ship.x+=1 end
if btn(U) then ship.y-=1 end
if btn(D) then ship.y+=1 end
</code></pre>
<p>On each frame, <code>_update</code> new checks to see if an arrow key is being held down.
If it is, it changes the pixel coordinate of the ship by <code>1</code> in the appropriate
direction.</p>
<p>Hit <code>ctrl-r</code> to run your cart and try it out!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="04-fire-laser-bullets"><a class="header" href="#04-fire-laser-bullets">04. Fire Laser Bullets</a></h1>
<video controls width="512" poster="tut_4.gif">
    <source src="./tut_4.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_04/./tut_4.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_4.gif">Original Source</a>)</p>
<div><img src="ss/step_04/./code1.png" width="512"/></div>
<p>Update <code>_init</code> to have a table to hold information about all of the bullets.</p>
<pre><code class="language-lua">function _init()
 ship={sp=1,x=60,y=60}
 bullets={}
end
</code></pre>
<p>Now add a <code>fire</code> function to create a new bullet and add it to the bullets
table.</p>
<pre><code class="language-lua">function fire()
 local b={
  sp=3,         -- which sprite to display for bullets
  x=ship.x,     -- start bullets at the ship's location
  y=ship.y,
  dx=0,
  dx=-3,        -- bullets move up from the ships location
 }
 add(bullets,b) -- add bullet to the table of bullets
end
</code></pre>
<div><img src="ss/step_04/./code2.png" width="512"/></div>
<p>Bullets move after being fired. This is an update operation and not a draw
operation so we will add it in <code>_update</code>.</p>
<pre><code class="language-lua">function _update()
 t=t+1

 for b in all(bullets) do
  b.x+=b.dx
  b.y+=b.dy
 end
</code></pre>
<p>We will need a way to trigger the firing of a bullet. Add this <code>if</code> statement at the end of <code>_update</code>. It will cause a bullet to fire if you press <code>X</code>.</p>
<pre><code class="language-lua">if btnp(X) then fire() end
</code></pre>
<p><strong>Note:</strong> We use <code>btnp</code> instea of <code>btn</code> to limit the rate of firing. </p>
<div><img src="ss/step_04/./code3.png" width="512"/></div>
<p>Let's display the bullets.</p>
<pre><code class="language-lua">function _draw
 cls()
 spr(ship.sp,ship.x,ship.y)
 for b in all(bullets) do
  spr(b.sp,b.x,b.y)
 end
end
</code></pre>
<p>Finally, let's actually create the bullet sprite so we have something to draw!</p>
<div><img src="ss/step_04/./bullet.png" width="512"/></div>
<p>Hit <code>ctrl-r</code> to run the game and then press <code>X</code> a few times. You should see something like this.</p>
<div><img src="ss/step_04/./result.png" width="512"/></div>
<p>Don't get carried away and fire too many! The code we wrote in this step has a
<strong>fatal</strong> flaw. It never forgets about any of the bullets that have been fired. As
bullets are fired an ever increasing amount of memory is consumed. It will also
take an ever increasing amount of time to update the position of the bullets
and draw them.  Taken to the extreme, it has the potential to crash the game or
make it unplayable.</p>
<p>This isn't a safe play to remain so we will address this in the next step.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="05-remove-bullets"><a class="header" href="#05-remove-bullets">05. Remove Bullets</a></h1>
<video controls width="512" poster="tut_5.gif">
    <source src="./tut_5.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_05/./tut_5.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_5.gif">Original Source</a>)</p>
<p>The last step ended with a warning about a defect in our game. Defects happen
all the time when we code so it is good idea to learn how to find, reproduce,
and fix them.</p>
<p>Let's imagine that a player of our game reported a bug complaining that the
game was exhibiting unbounded resource consumption. The best bug reports come
with steps to reproduce, but we are not always so lucky.</p>
<p>Without steps to reproduce, the first step is to develop a theory for what
could be leading to the behavior described in the report. In this case, our
game is really simple. We display a single ship, can move it around, and can
repeatedly press a button to fire bullets.</p>
<p>Our game displays itself at 30 frames per second. It is theoretically possible
that something in the display logic has a memory leak, but such a defect would
most likely be showing up in other games. As a general rule of thumb, don't
blame your tools! Most of the time the problem is in the code you have just
written and not in a tool that has gone through a rigorous testing process.</p>
<p>Looking back at the code we've written, the only place where we accumulate
additional state instead of just overwriting it is the code to add new bullets
so that seems like the best place to focus.</p>
<p>Now that we have a theory (that the bullet handling code is causing the
resource consumption), it would be nice to be able to prove it.</p>
<p>Let's add some code to illustrate the problem. We will display the number of
bullets we are tracking. If the bullets are not being cleaned up, the count
should only ever go up.</p>
<pre><code class="language-lua">function _draw()
 cls()
 print(#bullets,9)
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game and fire some bullets.</p>
<div><img src="ss/step_05/./problem.png" width="512" /></div>
<p>In the screenshot above, we have fired a total of <code>10</code> bullets, but only <code>3</code>
are visible on the screen. This clearly indicates the problem. We should only
be tracking bullets that are visible. Anything that has gone off the screen is
a waste of memory and processing time.</p>
<div><img src="ss/step_05/./code2.png" width="512" /></div>
<p>That gives us an outline of what the fix should be. Let's implement it.</p>
<pre><code class="language-lua">function _update()
 t=t+1

 for b in all(bullets) do
  b.x+=b.dx
  b.y+=b.dy
  if b.x&lt;0 or b.x&gt;128 or
   b.y&lt;0 or b.y&gt;128 then
   del(bullets,b)
  end
 end
</code></pre>
<p>If a bullet's <code>x</code> or <code>y</code> coordinates ever go outside of the screen bounds, we
can safely get rid of it. The screen bounds are 0-128.</p>
<p>Before we test it, let's make a change to our bullet sprite to the bullets
stand out a bit more.</p>
<div><img src="ss/step_05/./bullet.png" width="512" /></div>
<p>Run the game with <code>ctrl-r</code> and let's see if we can get the number of bullets
being tracked to exceed the number of bullets on the screen.</p>
<div><img src="ss/step_05/./solution.png" width="512" /></div>
<p>The numbers now match no matter how many bullets we fire. Success! Bug fixed
and crisis averted!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="06-draw-enemies"><a class="header" href="#06-draw-enemies">06. Draw Enemies</a></h1>
<video controls width="512" poster="tut_6.gif">
    <source src="./tut_6.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_06/./tut_6.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_6.gif">Original Source</a>)</p>
<p>Start by adding a table to track enemies. Populate it with <code>10</code> enemies.</p>
<pre><code class="language-lua">function _init()
 ship={sp=1,x=60,y=60}
 bullets={}
 enemies={}
 for i=i,10 do
  add(enemies, {
   sp=17,
   x=i*16,
   y=60-i*8
  })
 end
end
</code></pre>
<p>At the end of the <code>_draw</code> function, add code to display the enemies.</p>
<pre><code class="language-lua">for e in all(enemies) do
 spr(e.sp,e.x,e.y)
end
</code></pre>
<p>Finally, let's add an enemy at location <code>017</code>.</p>
<div><img src="ss/step_06/./enemy.png" width="512" /></div>
<p>Press <code>ctrl-r</code> to run the game and you should see some enemies! You won't be
able to destroy them and they don't move, but it is a start!</p>
<div><img src="ss/step_06/./result.png" width="512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="07-move-enemies"><a class="header" href="#07-move-enemies">07. Move Enemies</a></h1>
<video controls width="512" poster="./tut_7.gif">
    <source src="./tut_7.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_07/./tut_7.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_7.gif">Original Source</a>)</p>
<p>In <code>_init</code>, update the enemy creation code.</p>
<pre><code class="language-lua">for i=i,10 do
 add(enemies, {
  sp=17,
  m_x=i*16,
  m_y=60-i*8,
  x=-32
  y=-32
  r=12
 })
end
</code></pre>
<p>In <code>_update</code>, add code to change the position of the enemies.</p>
<pre><code class="language-lua">function _update()
 t=t+1

 for e in all(enemies) do
  e.x=e.r*sin(t/50)+e.m_x
  e.y=e.r*cos(t/50)+e.m_y
 end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. You should see the enemies moving down the screen
in a circular pattern.</p>
<p>The enemies cannot hurt the player and vice versa. Come to think of it, the player doesn't even have any health. Let's explore that next.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="08-points-and-health"><a class="header" href="#08-points-and-health">08. Points and Health</a></h1>
<video controls width="512">
    <source src="./tut_8.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_08/./tut_8.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_8.gif">Original Source</a>)</p>
<p>Let's add a way to keep track of how much health the player has left. We will
use the seemingly ubiquitous measure of <strong>hearts</strong>.</p>
<p>Create two new sprites. The first represents a heart the player has and the
second represents the loss of a heart. These should be placed at locations
<code>033</code> and <code>034</code>, respectively.</p>
<div><img src="ss/step_08/./heart1.png" width="512" /></div>
<div><img src="ss/step_08/./heart2.png" width="512" /></div>
<p>The player will have a total of <code>4</code> possible hearts. Let's give them <code>3</code> so we can test the display of the missing heart.</p>
<pre><code class="language-lua">function _init()
 ship={sp=1,x=60,y=60,h=3}
</code></pre>
<p>At the end of <code>_draw</code>, add the hearts display logic.</p>
<pre><code class="language-lua">for i=1,4 do
 if i&lt;=ship.h then
  spr(33,80+6*i,3)
 else
  spr(34,80+6*i,3)
 end
end
</code></pre>
<p>Press <code>ctrl-r</code> to run the game. You should see <code>3</code> red hearts and <code>1</code> gray
heart in the upper right corner. The hearts should display <strong>on top of</strong> any
enemies that pass by. If not, double check you added the hearts display logic
at the <strong>end</strong> of <code>_draw</code> and not any earlier.</p>
<div><img src="ss/step_08/./result.png" width="512" /></div>
<p>Having a way to measure player health is good. Now we need a way to reduce it!
It would also be good to be able to damage those enemies with our trusty laser
cannon.</p>
<p>Implementing either of these first requires that we take a detour into the land
of <strong>collision detection</strong>. This is a vital topic for just about all games.</p>
<p>It will take us a few steps to get through it, but it will be worth it as it
unlocks much of what follows it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="09-collision-1-cleanup-and-prep"><a class="header" href="#09-collision-1-cleanup-and-prep">09. Collision 1: Cleanup and Prep</a></h1>
<video controls width="512" poster="tut_9.gif">
    <source src="./tut_9.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_09/./tut_9.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_9.gif">Original Source</a>)</p>
<p>We are going to make a few minor changes. The first is just a cleanup task.</p>
<pre><code class="language-lua">function _init()
 t=0

 ship={
  sp=1,
  x=60,
  y=100,
  h=3,
  p=0
 }
</code></pre>
<p>The variable <code>t</code> is now initialized within <code>_init</code>. This is just good practice.
It keeps all of your variable initialization in a single location.</p>
<p>The ship is now placed <code>40</code> pixels farther down on the screen. This is a more
traditional starting location for a ship in a space shooter.</p>
<p>The ship now holds a <code>p</code> property, which will be used to track how many points
the player has scored.</p>
<p>The addition of <code>p</code> makes the <code>ship</code> initialization a bit too long so we
changed the formatting so it is split over multiple lines. This makes it eaiser
to scan the code.</p>
<p>The final change is a reduction of the number of enemies created from <code>10</code> to
<code>4</code>. Having fewer entities in the game makes troublshooting collision detection
algorithms a git easier.</p>
<p>Of the changes we made, only the change to the number of enemies should be visible. Verify that by using <code>ctrl-r</code> to run the game.</p>
<div><img src="ss/step_09/./result1.png" width="512" /></div>
<p>With our bullet defect fixed, we no longer need to display the number of
bullets in our world. Let's reuse it to display the number of points that have
been scored.</p>
<pre><code class="language-lua">function _draw()
 cls()
 print(ship.p,9)
</code></pre>
<p>Let's prep for the addition of collision detection. Put this function above the <code>fire</code> function.</p>
<pre><code class="language-lua">function coll(a,b)
 --todo
end

</code></pre>
<p>In <code>_update</code>, call the collision function for each enemy.</p>
<pre><code class="language-lua">function _update()
 t=t+1

 for e in all(enemies) do
  e.x=e.r*sin(t/50)+e.m_x
  e.y=e.r*cos(t/50)+e.m_y
  if coll(ship,e) then
   --todo
  end
 end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. The only visible difference should be that firing a bullet no longer increases the count in the upper left corner.</p>
<div><img src="ss/step_09/./result2.png" width="512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="10-collision-2-define-boxes"><a class="header" href="#10-collision-2-define-boxes">10. Collision 2: Define Boxes</a></h1>
<video controls width="512" poster="./tut_10.gif">
    <source src="./tut_10.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_10/./tut_10.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_10.gif">Original Source</a>)</p>
<p>OK. This is a very code heavy step. It is merely setup for the next step.</p>
<p>Start by adding a <code>box</code> property to the <code>ship</code> table. This defines the
<strong>collison box</strong> of the ship. If the bounds of this box overlap with the bounds
of an enemy's box, the player should lose a heart.</p>
<pre><code class="language-lua">ship={
 sp=1,
 x=60,
 y=100,
 h=3,
 p=0,
 box={x1=0,y1=0,x2=7,y2=7}
}
</code></pre>
<p>Add a <code>box</code> property to the enemies.</p>
<pre><code class="language-lua">add(enemies, {
 sp=17,
 m_x=i*16,
 m_y=60-i*8,
 x=-32,
 y=-32,
 r=12,
 box={x1=0,y1=0,x2=7,y2=7}
})
</code></pre>
<p>Next, we add a box to our bullets. If a bullet's box intersects with an enemy's
box, the enemy should receive damage or be destroyed. Bullets are destroyed by
the impact.</p>
<pre><code class="language-lua">function fire()
 local b={
  sp=3,
  x=ship.x,
  y=ship.y,
  dx=0,
  dy=-3,
  box={x1=2,y1=0,x2=5,y2=4}
 }
end
</code></pre>
<p>This <strong>bounding box</strong> is smaller than the one for either enemies or the ship
since the bullet doesn't fill its tile.</p>
<p>The function <code>abs_box</code> goes above the placeholder <code>coll</code> function we added in
the last step. The <code>box</code> properties we added just tell us the size of the box.
To actually compute whether two objects on screen intersect, we need the pixel
coordinates of the box.</p>
<p>That is what this function does. It adds an object's <code>x</code> and <code>y</code> coordinates to
the <code>box</code>'s properties. It translates from the <em>relative</em> coordinates of the
box to its <em>absolute</em> coordinates.</p>
<p>This next change sets us up for calculating whether there was a collision
between two boxes. It takes two entities (<code>A</code> and <code>B</code>) and gets the screen
coordinates of the bounds of their <strong>bounding box</strong>.</p>
<pre><code class="language-lua">function coll(a, b)
 --todo
 box_a=abs_box(a)
 box_b=abs_box(b)
end
</code></pre>
<p>What do we have to show for all that typing? Nothing (just yet), at least, not
that we can see visually. We did plenty conceptually.</p>
<p>We added bounding boxes to our ship, enemies, and bullets. We can compute the
absolute (screen) coordinates of the bounding box for one of these entities. We
also updated our <code>coll</code> function to compute the bounding box for two different
entities which will be used to start causing damage to the ship, enemies, and
bullets.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="11-collision-3-collide-boxes"><a class="header" href="#11-collision-3-collide-boxes">11. Collision 3: Collide Boxes</a></h1>
<video controls width="512" poster="./tut_11.gif">
    <source src="./tut_11.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_11/./tut_11.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_11.gif">Original Source</a>)</p>
<p>Let's finish the implementation of <code>coll</code>.</p>
<pre><code class="language-lua">function coll(a,b)
 local box_a=abs_box(a)
 local box_b=abs_box(b)

 if box_a.x1&gt;box_b.x2 or
    box_a.y1&gt;box_b.y2 or
    box_b.x1&gt;box_a.x2 or
    box_b.y1&gt;box_a.y2
    return false
 end
 
 return true
end
</code></pre>
<p>This is the only code change shown in the original step 11. The video shows
bullets destroying enemies and the score incrementing by one with each enemy
destroyed, but if you try running the game now, that won't happen.</p>
<p>Luckily, the missing code is modified in step 13 so we can recreate the
original behavior. Add this to <code>_update</code>.</p>
<pre><code class="language-lua">for b in all(bullets) do
 b.x+=b.dx
 b.y+=b.dy
 if b.x&lt;0 or b.x&gt;128 or
  b.y&lt;0 or b.y&gt;128 then
  del(bullets,b)
 end
 for e in all(enemies) do
  if coll(b,e) then
   del(enemies,e)
   ship.p+=1
  end
 end
end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. Fire a few bullets with <code>x</code>. When one of them
hits an enemey, the enemy should disappear. The score should increment by one
with each enemy you destroy.</p>
<div><img src="ss/step_11/./result.png" width="512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="12-change-states"><a class="header" href="#12-change-states">12. Change states</a></h1>
<video controls width="512" poster="./tut_12.gif">
    <source src="./tut_12.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_12/./tut_12.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_12.gif">Original Source</a>)</p>
<p>There's no way for the player to lose the game. In this step, we are going to
introduce the concept of <em>game states</em>. We will have two.</p>
<p>The first we will call the <code>game</code> state. It means we should run the game loop
which controls the enemies, allows the player to move, etc.</p>
<p>The second we will call the <code>game over</code> state. In this state, we don't want to
show the enemies or the player. You shouldn't be able to control the ship. We
just want to display a message letting the user know they lost.</p>
<p>There are many different ways to represent these different states and to
control what happens in each of them. In this tutorial, we are going to use a
fairly advanced, but extremely elegant technique.</p>
<p>PICO-8 uses the Lua programming language. Functions in Lua can be redefined at
runtime. This makes it possible to <em>change</em> (whle the game is running!) the
<code>_update</code> and <code>_draw</code> functions PICO-8 calls during each frame.</p>
<p>The way we do this is by simply assigning the name of another function to the <code>_update</code> and <code>_draw</code> identifiers.</p>
<p>For example:</p>
<pre><code class="language-lua">_draw=a_different_draw_function
_update=a_different_update_function
</code></pre>
<p>The current <code>_update</code> and <code>_draw</code> functions represent what should happen when we are in our <code>game</code> state. These will be renamed and we will add new functions to call when we are in our <code>game over</code> state.</p>
<p><code>start</code> is the function that will replace assign the <code>game</code> state functions.
Add a call to it at the end of <code>_init</code>.</p>
<pre><code class="language-lua"> end
 start()
end
</code></pre>
<p>Add these functions right after <code>_init</code>.</p>
<pre><code class="language-lua">function start()
 _update=update_game
 _draw=draw_game
end

function game_over()
 _update=update_over
 _draw=draw_over
end

function update_over()
end

function draw_over()
 cls()
 print(&quot;game over&quot;,50,50,4)
end
</code></pre>
<p>Rename the existing <code>_update</code> function to `update_game.</p>
<pre><code class="language-lua">function update_game()
 t=t+1
</code></pre>
<p>Rename the existing <code>_draw</code> function to `draw_game.</p>
<pre><code class="language-lua">function draw_game()
 cls()
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. The game should run just as it did before as we
haven't added any code to change the game state. That's coming next.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="13-health-game-over-immortaility"><a class="header" href="#13-health-game-over-immortaility">13. Health, Game Over, Immortaility</a></h1>
<video controls width="512" poster="./tut_13.gif">
    <source src="./tut_13.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_13/./tut_13.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_13.gif">Original Source</a>)</p>
<p>Let's make it possible to lose the game!</p>
<p>Start by adding two properties to the <code>ship</code>. <code>t</code> will be used in some animation calculations. <code>imm</code> is used to indicate if the ship is temporarily invulnerable.</p>
<pre><code class="language-lua">ship={
 sp=1,
 x=60,
 y=100,
 h=4,
 p=0,
 t=0,
 imm=false,
 box={x1=0,y1=0,x2=7,y2=7}
}
</code></pre>
<p>The <code>h=4</code> in the above snippet isn't a typo. Having the starting number of ship
hearts set to <code>3</code> was great for testing the missing heart display
functionality, but we've done that so we no longer need to penalize the player,
especially since we are about to enable them to get hurt!</p>
<p>A couple of steps back, we added a placeholder to check if the ship collided with any enemies. It is time to implement that logic. Add this to <code>update_game</code>.</p>
<pre><code class="language-lua">function update_game()
 t=t+1
 if ship.imm then
  ship.t+=1
  if ship.t&gt;30 then
    ship.imm=false
    ship.t=0
  end
 end

 for e in all(enemies) do
  e.x=e.r*sin(t/50)+e.m_x
  e.y=e.r*cos(t/50)+e.m_y
  if coll(ship,e) and not ship.imm then
   ship.imm=true
   ship.h-=1
   if ship.h&lt;=0 then
    game_over()
   end
  end
 end
</code></pre>
<p>First, we check the <code>imm</code> flag. If it is set, the ship needs to be invulnerable
for a full second (<code>30</code> frames). Once that time has passed, clear the flag and
reset the <code>ship.t</code> counter.</p>
<p>As we loop through the enemies, check if the ship collided with the current
enemy. If so, set the <code>imm</code> flag to give the ship temporary invulnerability.
Reduce the number of hearts by one. Check to see if we are out of hearts. If we
are out of heats, transition to the <code>game over</code> state to let the player known.</p>
<p>In <code>draw_game</code>, only draw the ship if it is not invulnerable or for ever other four frames, if it is.</p>
<pre><code class="language-lua">function draw_game()
 cls()
 print(ship.p,9)
 if not ship.imm or t%8&lt;4 then
  spr(ship.sp,ship.x,ship.y)
 end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. Move the ship so it is in the path of the
enemies. The number of hearts should reduce by one each time it is hit. After
each hit, the ship should flash off and on periodically over a second before
becoming vulnerable again.</p>
<div><img src="ss/step_13/./result1.png" width="512" /></div>
<p>Once the last heart is lost, the game over screen should be displayed.</p>
<div><img src="ss/step_13/./result2.png" width="512" /></div>
<p>At this point, we have something that is starting to feel like a real game. The
ship can fire bullets which destroy enemies, it can be damaged by the enemies,
and once all its hearts are lost, the game ends!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="14-explosions"><a class="header" href="#14-explosions">14. Explosions</a></h1>
<video controls width="512" poster="./tut_14.gif">
    <source src="./tut_14.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_14/./tut_14.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_14.gif">Original Source</a>)</p>
<p>Let's make the enemies explode when they are destroyed.</p>
<p>Explosions are different from enemies or bullets so we need a table to track them. Put this in <code>_init</code>.</p>
<pre><code class="language-lua">bullets={}
enemies={}
explosions={}
</code></pre>
<p>Right above the <code>fire</code> function, add the <code>explode</code> function.</p>
<pre><code class="language-lua">function explode(x,y)
 add(explosions,{x=x,y=y,t=0})
end
</code></pre>
<p>In <code>update_game</code>, put this explosions loop right before the loop over the enemies.</p>
<pre><code class="language-lua">for ex in all(explosions) do
 ex.t+=1
 if ex.t==13 then
  del(explosions,ex)
 end
end

for e in all(enemies) do
</code></pre>
<p>In the bullets loop of <code>update_game</code>, add a call to <code>explode</code>.</p>
<pre><code class="language-lua">if coll(b,e) then
 del(enemies,e)
 ship.p+=1
 explode(e.x,e.y)
end
</code></pre>
<p>In <code>draw_game</code>, add a loop to draw all of the explosions.</p>
<pre><code class="language-lua">function draw_game()
 cls()
 print(ship.p,9)
 if not ship.imm or t%8&lt;4 then
  spr(ship.sp,ship.x,ship.y)
 end

 for ex in all(explosions) do
  circ(ex.x,ex.y,ex.t/3,8+ex.t%3)
 end
</code></pre>
<p>In the video, the score flashes during the explosion animation. The code to
flash the score is not in the video. Part of it belongs in the snippet we just
entered.</p>
<p>For now, this is an exercise for the reader to add.</p>
<p>Hit <code>ctrl-r</code> to run the game. Fire bullets with <code>X</code>. Whenever an enemy is
destroyed, an expanding, flashing circle should be displayed for about half a
second before it disappears.</p>
<div><img src="ss/step_14/./result.png" width="512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="15-stars"><a class="header" href="#15-stars">15. Stars</a></h1>
<video controls width="512" poster="./tut_15.gif">
    <source src="./tut_15.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_15/./tut_15.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_15.gif">Original Source</a>)</p>
<p>Let's add a moving star field. It will help give the illusion that the ship is moving through space!</p>
<p>In <code>_init</code>, add a stars table and populate it.</p>
<pre><code class="language-lua">explosions={}
stars={}
for i=1,128 do
 add(stars,{
  x=rnd(128),
  y=rnd(128),
  s=rnd(2)+1
 })
end
</code></pre>
<p>Each star has a random <code>X</code> and <code>Y</code> position and a random speed.</p>
<p>In <code>update_game</code>, add a loop to update the stars before the explosions loop.</p>
<pre><code class="language-lua">for st in all(stars) do
 st.y+=st.s
 if st.y&gt;=128 then
  st.y=0
  st.x=rnd(128)
 end
end
</code></pre>
<p>We move the stars down the screen at a speed of <code>st.s</code> pixels per frame. Once
it goes past the bottom of the screen, we move it back to the top of the screen
and give it a new random <code>X</code> position.</p>
<p>Stars do not need to be deleted since we continually reuse them. We will only ever have 128 stars in our table.</p>
<p>In <code>draw_game</code>, add a loop to display our stars.</p>
<pre><code class="language-lua">function draw_game()
 cls()
 for st in all(stars) do
  pset(st.x,st.y,6)
 end

 print(ship.p,9)
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. You should see a continually moving star field
background!</p>
<div><img src="ss/step_15/./result.png" width="512" /></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="16-enemy-movement-and-respawn"><a class="header" href="#16-enemy-movement-and-respawn">16. Enemy Movement and Respawn</a></h1>
<video controls width="512" poster="./tut_16.gif">
    <source src="./tut_16.mp4"
            type="video/mp4">
    Sorry, your browser doesn't support embedded videos.
</video>
<p><a href="ss/step_16/./tut_16.git">Image</a> (<a href="https://ztiromoritz.github.io/pico-8-shooter/gif/tut_16.gif">Original Source</a>)</p>
<p>The game as it stands now isn't very challenging. There are four enmeies. They
have a very predictable position and movement pattern. Once they are defeated,
no other enemies appear and you are left zooming through a star field with no
other threats.</p>
<p>In this, the final step of the original tutorial, we will add enemy respawn so
that once a wave of enemies is defeated or leaves the screen, another wave
takes their place.</p>
<p>Start by <em>deleting</em> the loop that creates the enemies out of <code>_init</code>. We are
going to move it elsewhere.</p>
<p>Create a <code>respawn</code> function just after <code>_init</code>.</p>
<pre><code class="language-lua">function respawn()
 local n=flr(rnd(9))+2
 for i=1,n do
  local d=-1
  if rnd(1)&lt;0.5 then d=1 end
  add(enemies, {
   sp=17,
   m_x=i*16,
   m_y=-20-i*8,
   d=d,
   x=-32
   y=-32
   r=12,
   box={x1=0,y1=0,x2=7,y2=7}
  })
 end
end
</code></pre>
<p>In <code>update_game</code>, add a check before the enemies loop to call <code>respawn</code> if
there are no more enemies. Modify the enemies loop to randomize their movement
patterns a bit and to remove enemies that have left the screen.</p>
<pre><code class="language-lua">if #enemies&lt;=0 then
 respawn()
end

for e in all(enemies) do
 e.m_y+=1.3
 e.x=e.r*sin(e.d*t/50)+e.m_x
 e.y=e.r*cos(t/50)+e.m_y
 if coll(ship,e) and not ship.emm then
  ship.imm=true
  ship.h-=1
  if ship.h&lt;=0 then
   game_over()
  end
 end

 if e.y&gt;150 then
  del(enemies,e)
 end
end
</code></pre>
<p>Hit <code>ctrl-r</code> to run the game. After defeating all of the enemies on the screen
or allowing them to go passed the ship off the bottom of the screen, more
enemies should take their place. Their movement patterns should be a bit
randomized and you fill finally be able to beat your high score of <code>4</code>!</p>
<div><img src="ss/step_16/./result.png" width="512" /></div>
<p>Congratulations! You have completed all of the steps of the original &quot;Space Shooter in 16 GIFs&quot; tutorial!</p>
<p>The fun doesn't have to stop here! There are many things left that you could do. Here are some ideas to get you started.</p>
<ul>
<li>Can you move your ship off of the screen? What would it take to prevent this?</li>
<li>Bullets go straight through enemies. In many shooters, bullets are destroyed
by the impact with an enemy. How would you implement this?</li>
<li>In order to restart the game, we have to reset the cart? Write code to prompt
the user to press a button to restart and then reset the cart for them.
There's a PICO-8 API to reset the cart. Find the documentation for it!</li>
<li>Our game has no sound! Create sounds for firing a bullet, being hit, and
destroying an enemy. Play the sounds at the appropriate times.</li>
<li>Our game has no music! Write a catchy tune to keep you singing along while
you save the galaxy from the green invaders.</li>
<li>All of the enemies can be defeated with a single hit. What would you need to
change to make it take more than one hit to destroy an enemy?</li>
<li>We only have one enemy type! How would you add more?</li>
<li>All of the enemies follow the same movement pattern. What are some other
movement patterns? How would you implement them?</li>
<li>None of our enemies shoot bullets at us. How would you implement enemy
bullets? Should enemy bullets hurt other enemies? Why or why not? How would
you implement either approach?</li>
<li>The ship can never regain any hearts. How would you add power ups to allow
the ship to recover hearts?</li>
<li>Being able to recover hearts is nice. What other power ups should be in the
game? What do they do? How long do they last?</li>
<li>Speaking of power ups, what about upgrading your laser cannon or swapping it
out for an entirely different type of gun? What should the different weapon
types be? How do you change them? Do they randomly appear? Do you have to buy
them in a shop between levels?</li>
<li>Our game has no levels. How long should a level be? What should change from
level to level? Enemy speed, strength, type? What about visual changes?
Colors, obstacles, music?</li>
<li>Our game has no story. Should it have a general back story you see when you
first run the game? Or should the story unfold as you progress from level to
level? How would you implement your choice?</li>
<li>Even if a game has no story you directly tell the user, having a back story
for your game makes it easier to design things that fit into the game and
don't feel out of place. What is the back story for your game? How does that
story influence how you think about your game?</li>
<li>We have no high score list. How would you implement one?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<p>This page contains a collection of resources you can use to further your
journey with PICO-8.</p>
<h2 id="nerdy-teachers-tutorials"><a class="header" href="#nerdy-teachers-tutorials">Nerdy Teachers Tutorials</a></h2>
<p>This is a collection of <a href="https://nerdyteachers.com/PICO-8/">very well done
tutorials</a> that walk you through a variety
of different PICO-8 related topics. It includes small games to make, game
elements, game mechanics, details on specific functions, and an excellent
platformer tutorial.</p>
<h2 id="micro-platformer"><a class="header" href="#micro-platformer">Micro Platformer</a></h2>
<p>Here is a <a href="https://www.lexaloffle.com/bbs/?pid=28248">simple platforming
engine</a> in 100 lines of code.</p>
<p>The same author released a follow up, more advanced successor to this called
the <a href="https://www.lexaloffle.com/bbs/?tid=28793">Advanced Micro Platformer</a>.</p>
<h2 id="a-pico-8-spaceshooter-in-16-gifs"><a class="header" href="#a-pico-8-spaceshooter-in-16-gifs">A PICO-8 Spaceshooter in 16 GIFs</a></h2>
<p>This is a fun way to demonstrate how quickly a game can be developed in PICO-8.
In just <a href="https://ztiromoritz.github.io/pico-8-shooter/">16 animated images</a>,
the author is able to create a fully functioning space shooter!</p>
<h2 id="game-development-with-pico-8"><a class="header" href="#game-development-with-pico-8">Game Development with PICO-8</a></h2>
<p><a href="https://mboffin.itch.io/gamedev-with-pico-8-issue1">A 72-page zine</a> about
doing game development with PICO-8.</p>
<h2 id="picozines"><a class="header" href="#picozines">PicoZines</a></h2>
<p>This is a collection of freely downloadable magazines about PICO-8 programming.</p>
<ul>
<li><a href="https://sectordub.itch.io/pico-8-fanzine-1">PicoZine #1</a></li>
<li><a href="https://sectordub.itch.io/pico-8-fanzine-2">PicoZine #2</a></li>
<li><a href="https://sectordub.itch.io/pico-8-fanzine-3">PicoZine #3</a></li>
<li><a href="https://sectordub.itch.io/-pico-8-zine-4">PicoZine #4</a></li>
</ul>
<h2 id="the-pico-8-educational-toolset"><a class="header" href="#the-pico-8-educational-toolset">The PICO-8 Educational Toolset</a></h2>
<p><a href="https://mboffin.itch.io/pico8-educational-toolset">A collection</a> of
self-contained examples that demonstrate a single technique. By combining the
techniques you have all you need to create a variety of games.</p>
<p>This toolset was created by Dylan Bennett. He is the author of the Adventure
Game Tutorial content on this site.</p>
<h2 id="pico-8-music-tutorials"><a class="header" href="#pico-8-music-tutorials">PICO-8 Music Tutorials</a></h2>
<p><a href="https://www.youtube.com/playlist?list=PLur95ujyAigsqZR1aNTrVGAvXD7EqywdS">55
videos</a>
on Youtube by Gruber. These walk you through the sound and music editors. He
also has a variety of remakes of popular songs elsewhere in his channel that
are worth checking out.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
