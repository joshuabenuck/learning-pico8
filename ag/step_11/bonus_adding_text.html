<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Bonus Step: Adding Text</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../overview/overview.html">Overview</a></li><li class="chapter-item expanded "><a href="../../community/intro.html"><strong aria-hidden="true">1.</strong> The Community</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../community/splore.html"><strong aria-hidden="true">1.1.</strong> Splore</a></li></ol></li><li class="chapter-item expanded "><a href="../../using/intro.html"><strong aria-hidden="true">2.</strong> Using PICO-8</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../using/limitations.html"><strong aria-hidden="true">2.1.</strong> Limitations</a></li><li class="chapter-item expanded "><a href="../../using/code_editor.html"><strong aria-hidden="true">2.2.</strong> Code Editor</a></li><li class="chapter-item expanded "><a href="../../using/sprite_editor.html"><strong aria-hidden="true">2.3.</strong> Sprite Editor</a></li><li class="chapter-item expanded "><a href="../../using/map_editor.html"><strong aria-hidden="true">2.4.</strong> Map Editor</a></li><li class="chapter-item expanded "><a href="../../using/sound_editor.html"><strong aria-hidden="true">2.5.</strong> Sound Editor</a></li><li class="chapter-item expanded "><a href="../../using/music_editor.html"><strong aria-hidden="true">2.6.</strong> Music Editor</a></li><li class="chapter-item expanded "><a href="../../using/coordinates.html"><strong aria-hidden="true">2.7.</strong> Coordinates</a></li><li class="chapter-item expanded "><a href="../../using/programming_basics.html"><strong aria-hidden="true">2.8.</strong> Programming Basics</a></li><li class="chapter-item expanded "><a href="../../using/the_game_loop.html"><strong aria-hidden="true">2.9.</strong> The Game Loop</a></li></ol></li><li class="chapter-item expanded "><a href="../../flappy/tutorial.html"><strong aria-hidden="true">3.</strong> Flappy Bird Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../flappy/code.html"><strong aria-hidden="true">3.1.</strong> Code Only</a></li></ol></li><li class="chapter-item expanded "><a href="../../ag/intro/ag_tutorial.html"><strong aria-hidden="true">4.</strong> Adventure Game Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ag/step_01/the_map.html"><strong aria-hidden="true">4.1.</strong> The Map</a></li><li class="chapter-item expanded "><a href="../../ag/step_02/the_player.html"><strong aria-hidden="true">4.2.</strong> The Player</a></li><li class="chapter-item expanded "><a href="../../ag/step_03/movement.html"><strong aria-hidden="true">4.3.</strong> Movement</a></li><li class="chapter-item expanded "><a href="../../ag/step_04/camera.html"><strong aria-hidden="true">4.4.</strong> Camera</a></li><li class="chapter-item expanded "><a href="../../ag/step_05/keys.html"><strong aria-hidden="true">4.5.</strong> Keys</a></li><li class="chapter-item expanded "><a href="../../ag/step_06/inventory.html"><strong aria-hidden="true">4.6.</strong> Inventory</a></li><li class="chapter-item expanded "><a href="../../ag/step_07/doors.html"><strong aria-hidden="true">4.7.</strong> Doors</a></li><li class="chapter-item expanded "><a href="../../ag/step_08/animated_tiles.html"><strong aria-hidden="true">4.8.</strong> Animate Tiles</a></li><li class="chapter-item expanded "><a href="../../ag/step_09/winning_and_losing.html"><strong aria-hidden="true">4.9.</strong> Winning and Losing</a></li><li class="chapter-item expanded "><a href="../../ag/step_10/trying_again.html"><strong aria-hidden="true">4.10.</strong> Trying Again</a></li><li class="chapter-item expanded "><a href="../../ag/step_11/bonus_adding_text.html" class="active"><strong aria-hidden="true">4.11.</strong> Bonus Step: Adding Text</a></li><li class="chapter-item expanded "><a href="../../ag/step_12/bonus_unlimited_sprite_types.html"><strong aria-hidden="true">4.12.</strong> Bonus Step: Unlimited Sprite Types</a></li></ol></li><li class="chapter-item expanded "><a href="../../ss/intro/intro.html"><strong aria-hidden="true">5.</strong> A Space Shooter in 16 Steps</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ss/step_01/draw_ship.html"><strong aria-hidden="true">5.1.</strong> Draw Ship on Screen</a></li><li class="chapter-item expanded "><a href="../../ss/step_02/animate_propulsion.html"><strong aria-hidden="true">5.2.</strong> Animate Propulsion</a></li><li class="chapter-item expanded "><a href="../../ss/step_03/ship_movement.html"><strong aria-hidden="true">5.3.</strong> Basic Ship Movement</a></li><li class="chapter-item expanded "><a href="../../ss/step_04/fire_bullets.html"><strong aria-hidden="true">5.4.</strong> Fire Laser Bullets</a></li><li class="chapter-item expanded "><a href="../../ss/step_05/remove_bullets.html"><strong aria-hidden="true">5.5.</strong> Remove Bullets</a></li><li class="chapter-item expanded "><a href="../../ss/step_06/draw_enemies.html"><strong aria-hidden="true">5.6.</strong> Draw Enemies</a></li><li class="chapter-item expanded "><a href="../../ss/step_07/move_enemies.html"><strong aria-hidden="true">5.7.</strong> Move Enemies</a></li><li class="chapter-item expanded "><a href="../../ss/step_08/points_and_health.html"><strong aria-hidden="true">5.8.</strong> Points and Health</a></li><li class="chapter-item expanded "><a href="../../ss/step_09/cleanup_and_prep.html"><strong aria-hidden="true">5.9.</strong> Collision 1: Cleanup and Prep</a></li><li class="chapter-item expanded "><a href="../../ss/step_10/define_boxes.html"><strong aria-hidden="true">5.10.</strong> Collision 2: Define Boxes</a></li><li class="chapter-item expanded "><a href="../../ss/step_11/collide_boxes.html"><strong aria-hidden="true">5.11.</strong> Collision 3: Collide Boxes</a></li><li class="chapter-item expanded "><a href="../../ss/step_12/change_states.html"><strong aria-hidden="true">5.12.</strong> Change states</a></li><li class="chapter-item expanded "><a href="../../ss/step_13/game_over.html"><strong aria-hidden="true">5.13.</strong> Health, Game Over, Immortaility</a></li><li class="chapter-item expanded "><a href="../../ss/step_14/explosions.html"><strong aria-hidden="true">5.14.</strong> Explosions</a></li><li class="chapter-item expanded "><a href="../../ss/step_15/stars.html"><strong aria-hidden="true">5.15.</strong> Stars</a></li><li class="chapter-item expanded "><a href="../../ss/step_16/enemy_movement.html"><strong aria-hidden="true">5.16.</strong> Enemy Movement and Respawn</a></li></ol></li><li class="chapter-item expanded "><a href="../../resources/resources.html"><strong aria-hidden="true">6.</strong> Resources</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bonus-step-adding-text"><a class="header" href="#bonus-step-adding-text">Bonus Step: Adding Text</a></h1>
<p>This step will be a bit more involved than the previous steps. If you have
made it to this step, you will definitely be able to complete it. Just take
it slow and don't rush.</p>
<p>Create a sign sprite.</p>
<p><img src="./sign.png" alt="Sign" /></p>
<p>Place two of them. If you don't place them at x=1,y=3 and x=7,y=3 you will need to update the code to reflect where the signs are placed in your world.</p>
<p><img src="./sign1.png" alt="Sign1" /></p>
<p><img src="./sign2.png" alt="Sign2" /></p>
<p>Add <code>text=5</code> to the <code>tile settings</code> in <code>map_setup</code>.  We are going to use this
to trigger the display of text to the user.</p>
<p><img src="./text_flag.png" alt="Text Flag" /></p>
<p>Now, let's add some code to make use of this tile type.</p>
<p>In tab <code>0</code>, add a call to <code>text_setup</code></p>
<pre><code class="language-lua">function _init()
 map_setup()
 text_setup()
 make_player()
 
</code></pre>
<p>Modify the <code>_update</code> call to only update the game state if there is no active text displayed.</p>
<pre><code class="language-lua">function _update()
 if (not game_over) then
  if (not active_text) then
   update_map()
   move_player()
   check_win_lose()
  end
</code></pre>
<p>In <code>_draw</code>, call <code>draw_text</code> after drawing the map and the player.</p>
<pre><code class="language-lua">function _draw()
 cls()
 if (not game_over) then
  draw_map()
  draw_player()
  draw_text()
</code></pre>
<p>In the player interaction code, tab <code>2</code>, add a check for the text tile type.</p>
<pre><code class="language-lua">function interact(x,y)
 if (is_tile(text,x,y)) then
  active_text=get_text(x,y)
 end

</code></pre>
<p>Add a new tab. This will be tab <code>6</code>. We will put the text related code here.</p>
<pre><code class="language-lua">--text code

function text_setup()
 texts={}
 add_text(1,3,&quot;first sign!&quot;)
 add_text(7,3,&quot;oh, look!\na sign!&quot;)
end

function add_text(x,y,message)
 texts[x+y*128]=message
end

function get_text(x,y)
 return texts[x+y*128]
end

function draw_text()
 if (active_text) then
  textx=mapx*8+4
  texty=mapy*8+48
  
  rectfill(textx,texty,textx+119,texty+31,7)
  print(active_text,textx+4,texty+4,1)
  print(&quot;_ to close&quot;,textx+4,texty+23,6)
 end
 
 if (btnp(_)) active_text=nil
end
</code></pre>
<p>Save your game and run it. With any luck, you should be able to walk up to and read each sign.</p>
<p><img src="./sign1_shown.png" alt="Sign1 Shown" /></p>
<p><img src="./sign2_shown.png" alt="Sign2 Shown" /></p>
<p>This opens up a world of possibilities. It allows to add Non-Player Characters
(NPCs) that can speak with your character. Signs can provide instructions or
warnings. You are able to tell your character's back story through dialog or notes or other narrative devices.</p>
<h1 id="result"><a class="header" href="#result">Result</a></h1>
<iframe width="750px" height="680px" src="./adventuregame_bonus_step_text.html"></iframe>
<a href="./adventuregame_bonus_step_text.p8.png" target="_blank">Download</a>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ag/step_10/trying_again.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../ag/step_12/bonus_unlimited_sprite_types.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ag/step_10/trying_again.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../ag/step_12/bonus_unlimited_sprite_types.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
